<div ng-init="load()">
  <div class="content" ng-show="!records || records.length == 0">
    <div class="table_wrap table_height">
      <div class="row table-responsive table_inner">
          <div class="controls" ng-show="records.length == 0 && Records">
            <h4 >No hay registros para mostrar</h4>
          </div>
          <p class="text-center" ng-show="!Records">
           <img style="width:50px;" src="images/loading.svg">
          </p>
      </div>
    </div>  
  </div>
<div class="col-lg-12 content" ng-show="records.length > 0">
        <button 
          type="button" 
          ng-json-export-excel 
          data="data_export" 
          report-fields="{ref: 'ref', descripcion: 'descripcion', unidades: 'unidades', dcto: 'dcto', precio_venta: 'costo', numpedido: 'numpedido'}" 
          filename =" 'export-excel' " 
          separator=","  
          style="margin-bottom:5px;" 
          class="btn custom-btn-primary">
          <i class="fa fa-file-excel-o"></i>&nbsp;Exportar</button>
        <a
          ng-show="LoteRecords.length > 0" 
          ng-click="ToProductionRequest()"
          style="margin-bottom:5px;" 
          class="btn custom-btn-primary">
          <i class="glyphicon glyphicon-list-alt"></i>&nbsp;Vista Previa</a>
        <div class="hpanel">
            <div class="panel-body">
            <div class="row">
            <div class="col-lg-2">
                <label>Fecha Inicial:</label>
                <p class="input-group">
                  <input ng-change="setFormat()" type="text" class="form-control" uib-datepicker-popup="{{format}}" ng-model="dt" is-open="popup2.opened" datepicker-options="dateOptions" ng-required="true" close-text="Cerrar" />
                  <span class="input-group-btn">
                    <button type="button" class="btn btn-default" ng-click="open2()"><i class="glyphicon glyphicon-calendar"></i></button>
                  </span>
                </p>
            </div>
            <div class="col-lg-2">
                <label>Fecha Final:</label>
                <p class="input-group">
                  <input ng-change="setFormatEnd()" type="text" class="form-control" uib-datepicker-popup="{{formatEnd}}" ng-model="dtEnd" is-open="popupEnd.opened" datepicker-options="dateOptionsEnd" ng-required="true" close-text="Cerrar" />
                  <span class="input-group-btn">
                    <button type="button" class="btn btn-default" ng-click="openEnd()"><i class="glyphicon glyphicon-calendar"></i></button>
                  </span>
                </p>
            </div>
            <div class="col-lg-2">
                <div class="form-group">
                  <label for="name" >Vendedor:</label>
                  <vendedor-field empty-option="true" placeholder="Vendedor"  ng-model="filter._seller" key="_id" label="name"><vendedor-field>
                </div>
            </div>
            <div class="col-lg-2">
                <div class="form-group">
                  <label for="name" >Cliente:</label>
                  <cliente-field empty-option="true" placeholder="Vendedor"  ng-model="filter._client" key="_id" label="full_name"><cliente-field>
                </div>
            </div>
              <div class="col-lg-3">
                <div class="form-group">
                  <label>Buscar</label>
                    <input type="text" ng-model="search" class="form-control input-sm m-b-md" id="filter" placeholder="Buscar en la tabla">
                </div>
              </div>
            </div>
                <div class="table-responsive">
          <table class="table table-hover">
              <thead>
                <tr>
                  <th></th>
                  <th>Codigo</th>
                  <th>Tipo</th>
                  <th>Vendedor</th>
                  <th>Cliente.</th>
                  <th>Ciudad</th>
                  <th>Dir</th>
                  <th>Total</th>
                  <th>Fecha</th>
                  <th>Estado</th>
                  <th></th>
                  <th style="width: 36px;"></th>
                </tr>
              </thead>
              <tbody>
                  <tr ng-show="!records || records.length == 0"><td class="text-center" colspan="9"><p class="text-center"><i class="glyphicon glyphicon-info-sign"></i>&nbsp;No existen registros.</p></td></tr>
                <tr 
                  ng-init="generateExport()"
                  pagination-id="OrdenesEntity"
                  dir-paginate="record in data.currentPageFiltered = (records
                  | dateRange:filter._ini:filter._end 
                  | filter:search 
                  | filter:{_client : { _id : filter._client}} 
                  | filter:{_seller : { _id : filter._seller}} 
                  | filter:{data : { tipo : filter._type}} 
                  | orderBy:'-createdAt')
                   
                  | itemsPerPage: 5 ">
                  <td>
                    <input icheck type="checkbox" ng-change="validateLote()" ng-model="record.add" class="info-bounce">
                    </label> 
                  </td>
                  <td>{{record.id}}</td>
                  <td>
                    <span ng-show="record.data.tipo == 'Orden de Pedido' " class="label label-info">Pedido</span>

                    <span ng-show="record.data.tipo == 'Remisión'" class="label label-primary">Remisión</span>
                  </td>
                  <td>{{record._seller.full_name.toLowerCase()}}</td>
                  <td>{{record._client.full_name.toLowerCase() || record._client.data.razon_social.toLowerCase()}}</td>
                  <td>{{record.metadata.ciudad.toLowerCase()}}</td>
                  <td>{{record.metadata.direccion.toLowerCase()}}</td>
                  <td>{{record.data.total | currency:"$ "}}</td>
                  <td>{{record.createdAt | date:"yyyy-MM-dd"}}</td>
                  <td>{{record.data.estado || 'Pendiente'}}</td>
                  <td></td>
                  <td><button ng-click="detail()" type="button" class="btn btn-success btn-xs"><i class="glyphicon glyphicon-eye-open"></i>&nbsp;</button></td>
                  <td><button ng-click="location()" type="button" class="btn custom-btn-primary btn-xs"><i class="glyphicon glyphicon-map-marker"></i>&nbsp;</button></td>
                  <td><button ng-click="delete()" type="button" class="btn btn-danger btn-xs"><i class="glyphicon glyphicon-trash"></i>&nbsp;</button></td>
                  <td>
                  <button 
                    ng-json-export-excel 
                    data="single_data_export" 
                    report-fields="{ref: 'ref', descripcion: 'descripcion', unidades: 'unidades', dcto: 'dcto', precio_venta: 'costo', numpedido: 'numpedido'}" 
                    filename =" 'export-excel' " 
                    separator=","  
                    type="button" class="btn custom-btn-primary btn-xs"><i class="fa fa-file-excel-o"></i>
                  </button>
                  </td>
                  <td><button ng-click="ToSingleProductionRequest()" type="button" class="btn btn-success btn-xs"><i class="glyphicon glyphicon-list-alt"></i>&nbsp;OP</button></td>
                </tr>
              </tbody>
            </table>
                <p>Total Productos Selecionados : &nbsp;<span class="label label-info">{{LoteRecords.length || 0}}</span></p>
                </div>
                <div class="col-lg-12">
                  <dir-pagination-controls class="pull-right" pagination-id="OrdenesEntity"></dir-pagination-controls>
                </div>
            </div>
            <div class="panel-footer">
                Listado de Ordenes
            </div>
        </div>
    </div>
	<div class="row" ng-show="records.length > 0">
</div>
